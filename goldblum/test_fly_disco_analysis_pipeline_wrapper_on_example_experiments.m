reset_goldblum_example_experiments_working_copy_folder() ;

this_script_file_path = mfilename('fullpath') ;
this_script_folder_path = fileparts(this_script_file_path) ;
fly_disco_analysis_folder_path = fileparts(this_script_folder_path) ;

settings_folder_path = fullfile(fly_disco_analysis_folder_path, 'settings') ;

analysis_parameters = ...
        {'doautomaticchecksincoming',true,...
         'doflytracking',true,...
         'doregistration',true,...
         'doledonoffdetection',true,...
         'dotrackwings',true,...
         'dosexclassification',true,...
         'docomputeperframefeatures',true,...
         'docomputehoghofperframefeatures',false,...
         'dojaabadetect',true,...
         'docomputeperframestats',false,...
         'doplotperframestats',false,...
         'domakectraxresultsmovie',false,...
         'doextradiagnostics',false,...
         'doanalysisprotocol',false,...
         'doautomaticcheckscomplete',false } ;

example_experiments_folder_path = ...
    fullfile(this_script_folder_path, ...
             'example-experiments-working-copy') ;        
     
folder_name_from_experiment_index = simple_dir(example_experiments_folder_path) ;
do_run_from_experiment_index = true(size(folder_name_from_experiment_index)) ;  % modify this to run a subset

experiment_count = length(folder_name_from_experiment_index) ;
for experiment_index = 1 : experiment_count ,
    do_run = do_run_from_experiment_index(experiment_index) ;
    if do_run ,    
        experiment_folder_name = folder_name_from_experiment_index{experiment_index} ;
        experiment_folder_path = fullfile(example_experiments_folder_path, experiment_folder_name) ;         

        fprintf('\n\n\nRunning fly_disco_analysis_pipeline_wrapper() on %s ...\n', experiment_folder_name) ;

        % Call the function to do the real work
        fly_disco_analysis_pipeline_wrapper(experiment_folder_path, settings_folder_path, analysis_parameters) ;

        % If get here, must have worked
        fprintf('fly_disco_analysis_pipeline_wrapper() ran successfully on experiment %s !\n', experiment_folder_name) ;
    end
end
