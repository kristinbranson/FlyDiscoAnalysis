reset_goldblum_example_experiments_working_copy_folder() ;

this_script_file_path = mfilename('fullpath') ;
this_script_folder_path = fileparts(this_script_file_path) ;
fly_disco_analysis_folder_path = fileparts(this_script_folder_path) ;

settings_folder_path = fullfile(fly_disco_analysis_folder_path, 'settings-internal') ;

analysis_parameters = ...
        {'doautomaticchecksincoming',true,...
         'doflytracking',true,...
         'doregistration',true,...
         'doledonoffdetection',true,...
         'dotrackwings',true,...
         'dosexclassification',true,...
         'docomputeperframefeatures',true,...
         'docomputehoghofperframefeatures',false,...
         'dojaabadetect',true,...
         'docomputeperframestats',false,...
         'doplotperframestats',false,...
         'domakectraxresultsmovie',false,...
         'doextradiagnostics',false,...
         'doanalysisprotocol',false,...
         'doautomaticcheckscomplete',false } ;

example_experiments_folder_path = ...
    fullfile(this_script_folder_path, ...
             'example-experiments-working-copy') ;        

folder_path_from_experiment_index = find_experiment_folders(example_experiments_folder_path) ;
% folder_path_from_experiment_index = ...
%     { '/groups/branson/bransonlab/taylora/flydisco/FlyDiscoAnalysis/goldblum/example-experiments-working-copy/FlyBowlOpto/SS36564_20XUAS_CsChrimson_mVenus_attP18_flyBowlMing_20200227_Continuous_2min_5int_20200107_20200229T132141', ... 
%       '/groups/branson/bransonlab/taylora/flydisco/FlyDiscoAnalysis/goldblum/example-experiments-working-copy/FlyBowlOpto/emptysplit_20xUAS-ChrimsonRmVenusattp18_flyBowlMing_nopause_lengthofpersis_2min_10int_20191218T093239_2'   , ...
%       '/groups/branson/bransonlab/taylora/flydisco/FlyDiscoAnalysis/goldblum/example-experiments-working-copy/FlyBubbleRGB/LED/locomotionGtACR1_24_EXT_VGLUT-GAL4_RigA_20210226T095136'                                              , ...
%       '/groups/branson/bransonlab/taylora/flydisco/FlyDiscoAnalysis/goldblum/example-experiments-working-copy/FlyBubbleRGB/noLED/locomotionGtACR1_emptySplit24b_RigB_20210216T105603'                                                } ;
do_run_from_experiment_index = true(size(folder_path_from_experiment_index)) ;  % modify this to run a subset

experiment_count = length(folder_path_from_experiment_index) ;
for experiment_index = 1 : experiment_count ,
    do_run = do_run_from_experiment_index(experiment_index) ;
    if do_run ,    
        experiment_folder_path = folder_path_from_experiment_index{experiment_index} ;
        [~,experiment_folder_name] = fileparts2(experiment_folder_path) ;

        fprintf('\n\n\nRunning goldblum_FlyDiscoPipeline_wrapper() on %s ...\n', experiment_folder_name) ;

        % Call the function to do the real work
        goldblum_FlyDiscoPipeline_wrapper(experiment_folder_path, settings_folder_path, analysis_parameters) ;

        % If get here, must have worked
        fprintf('goldblum_FlyDiscoPipeline_wrapper() ran successfully on experiment %s !\n', experiment_folder_name) ;
    end
end
