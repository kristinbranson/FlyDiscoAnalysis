this_script_file_path = mfilename('fullpath') ;
this_script_folder_path = fileparts(this_script_file_path) ;
experiment_folder_path = ...
    fullfile(this_script_folder_path, ...
             'analysis-test-folder', ...
             'locomotionGtACR1_24_EXT_VGLUT-GAL4_RigA_20210226T095136') ;
         
%analysis_protocol_folder_path = fullfile(this_script_folder_path, 'FlyDiscoAnalysis/settings/20210228_flybubble_dickson_locomotionGtACR1') ;

settingsdir = fullfile(this_script_folder_path, 'FlyDiscoAnalysis/settings');

%% parameters

analysis_protocol = '20210228_flybubble_dickson_locomotionGtACR1';
% analysis_protocol = '20210219_flybubble_dickson_nochrGtACR1testing'

params = {'settingsdir',settingsdir,...
    'analysis_protocol',analysis_protocol, ...
    'forcecompute',true,...
    'doautomaticchecksincoming',true,...
    'doflytracking',false, ...
    'doregistration',true,...
    'doledonoffdetection',false,...
    'dosexclassification',false,...
    'dotrackwings',false,...
    'docomputeperframefeatures',false,...
    'docomputehoghofperframefeatures',false,...
    'dojaabadetect',false,...
    'docomputeperframestats',false,...
    'doplotperframestats',false,...
    'domakectraxresultsmovie',true,...
    'doextradiagnostics',false,...
    'doanalysisprotocol',isunix,...
    'doautomaticcheckscomplete',false};

%% experiment directory
% manually tracked by Alice 
%expdir = '/groups/branson/home/robiea/Projects_data/FlyDisco/Bubble_data/locomotionGtACR1_24_EXT_VGLUT-GAL4_RigA_20210226T095136';

%% run
% for i = 1:numel(explist)
%     expdir = explist{i};
% [success,msgs,stage] = FlyBubblePipeline(expdir,params{:});
% end

[success,msgs,stage] = FlyDiscoPipeline(experiment_folder_path,params{:});
